#!/bin/sh
# ==============================================================================
# Start calendar2image service
# ==============================================================================

echo "[INFO] Starting Calendar2Image on port 3000..."

# Export Puppeteer environment variables
export PUPPETEER_SKIP_CHROMIUM_DOWNLOAD=true
export PUPPETEER_EXECUTABLE_PATH=/usr/bin/chromium
export CHROMIUM_PATH=/usr/bin/chromium

# Set config and templates directory to /config
export CONFIG_DIR=/config
export TEMPLATES_DIR=/config/templates

# Set addon slug and host path (these should be set by init script)
# But provide defaults just in case
export ADDON_SLUG=${ADDON_SLUG:-calendar2image}
export HOST_CONFIG_PATH=${HOST_CONFIG_PATH:-/addon_configs/${ADDON_SLUG}}

cd /app
exec node src/index.js
